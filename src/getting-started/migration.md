---
layout: layout.njk
eleventyNavigation:
  key: "Migration"
  title: "ðŸšš Migration"
  order: 100
summary: Some tips for migration from Parcel 1 to Parcel 2
---

For the most part, you shouldn't have to change much when upgrading to Parcel 2:

### Importing non-code assets from Javascript

If you want import the url to an image (or a soundfile, etc.) from Javascript, you need to prepend `url:` to the module specifier.

{% migration %}
{% samplefile "index.js" %}

```js/0
import logo from "./logo.svg";

document.body.innerHTML = `<img src="${logo}">`;
```

{% endsamplefile %}
{% samplefile %}

```js/0
import logo from "url:./logo.svg";

document.body.innerHTML = `<img src="${logo}">`;
```

{% endsamplefile %}
{% endmigration %}

Alternatively, you can use a custom `.parcelrc` to opt into the old behaviour.

{% migration %}
{% samplefile ".parcelrc" %}

```json/3
{
  "extends": "@parcel/config-default",
  "transforms": {
    "*": ["@parcel/transformer-raw"]
  },
}
```

{% endsamplefile %}
{% endmigration %}

## Configuration/CLI

### `package.json#main`

Many `package.json`s (e.g. the one generated by `npm init`) contains `main: "index.js"` which ignored by most tools (for non-library projects). Parcel 2 will however use that value as the output path (see [Configuration#main](/getting-started/configuration#main-%2F-module-%2F-browser)),
for most web apps, this line should simply be removed.

### `--target`

This CLI flag is now inferred from your `package.json`, one of these three properties is enough (number denotes priority).

{% migration %}
{% samplefile %}

```bash
parcel build index.js --target node
```

{% endsamplefile %}
{% samplefile "package.json" %}

```json5/3,5,10
{
  "targets": {
    "default": {
      "context": "node", // <-- (1)
      "engines": {
        "node": "10" // <------ (2)
      }
    }
  },
  "engines": {
    "node": "10" // <---------- (3)
  }
}
```

{% endsamplefile %}
{% endmigration %}


### `--experimental-scope-hoisting`

Parcel 2 has scope hoisting enabled by default; to disable it, add `--no-scope-hoist`.

{% migration %}
{% samplefile %}

```bash
parcel build index.js --experimental-scope-hoisting
parcel build index.js
```

{% endsamplefile %}
{% samplefile %}

```bash
parcel build index.js
parcel build index.js --no-scope-hoist
```

{% endsamplefile %}
{% endmigration %}


### `--bundle-node-modules`

To bundle packages from `node_modules` when targetting Node.js, you now should specify that in the target configuration:

{% migration %}
{% samplefile %}

```bash
parcel build index.js --target node --bundle-node-modules
```

{% endsamplefile %}
{% samplefile "package.json" %}

```json5/8
{
  "default": "dist/index.js"
  "targets": {
    "default": {
      "includeNodeModules": true
    }
  },
  "engines": {
    "node": "10"
  }
}
```

{% endsamplefile %}
{% endmigration %}


{% note %}

This option is more versatile that the CLI parameter (you can also selectively include packages), see [Configuration#includeNodeModules](/getting-started/configuration/#includenodemodules) for all details.

{% endnote %}

### `--out-dir`

To align `--out-dir` with the options in `package.json#targets`, that option was renamed to `--dist-dir`.

### `--out-file`

This flag, was removed and should the path should instead be be specified in `package.json` instead (see [Configuration](/getting-started/configuration) TODO LINK).

{% migration %}
{% samplefile %}

```bash
parcel build index.js --out-file lib.js
```

{% endsamplefile %}
{% samplefile "package.json" %}

```json5/1
{
  "default": "lib.js",
  // ...
}
```

{% endsamplefile %}
{% endmigration %}

### `--log-level`

The log levels now have names instead of numbers (`none`, `error`, `warn`, `info`, `verbose`)

{% migration %}
{% samplefile %}

```bash
parcel build index.js --log-level 1
```

{% endsamplefile %}
{% samplefile %}

```bash
parcel build index.js --log-level error
```

{% endsamplefile %}
{% endmigration %}

### `--detailed-report`

This option has been removed without a replacement (and has never influenced the build output).

{% migration %}
{% samplefile %}

```bash
parcel build index.js --detailed-report
```

{% endsamplefile %}
{% samplefile %}

```bash
parcel build index.js
```

{% endsamplefile %}
{% endmigration %}

### `--no-content-hash`

TODO we should add this again

This option has been removed without a replacement, but a custom namer plugin can have complete control over the bundle names.

{% migration %}
{% samplefile %}

```bash
parcel build index.js --no-content-hash
```

{% endsamplefile %}
{% samplefile %}

```bash
parcel build index.js
```

{% endsamplefile %}
{% endmigration %}

### `--global`

TODO we should add this again

This option has been removed without a replacement (for now).

{% migration %}
{% samplefile %}

```bash
parcel build index.js --global mylib
```

{% endsamplefile %}
{% samplefile %}

```bash
parcel build index.js
```

{% endsamplefile %}
{% endmigration %}
